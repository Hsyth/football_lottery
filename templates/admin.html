<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>âš½ å¹´ä¼šæŠ½å¥–åå°</title>

<style>
body {
    margin: 0;
    background: linear-gradient(180deg, #0b5d2a, #063b1a);
    font-family: "PingFang SC", sans-serif;
    color: #fff;
    text-align: center;
}

h1 {
    margin: 20px 0 10px;
}

.card {
    background: rgba(255,255,255,0.1);
    border-radius: 16px;
    padding: 18px;
    margin: 16px;
}

select, button {
    padding: 12px 18px;
    border-radius: 24px;
    border: none;
    font-size: 16px;
    margin: 6px;
}

button {
    background: #2ecc71;
    color: #000;
    font-weight: bold;
}

button.danger {
    background: #e74c3c;
    color: #fff;
}

/* ğŸ° ä¸‰è¡Œæ»šåŠ¨åŒº */
.roller {
    width: 260px;
    margin: 20px auto;
    overflow: hidden;
    border-radius: 14px;
    background: rgba(0,0,0,0.35);
}

.row {
    height: 56px;
    line-height: 56px;
    font-size: 22px;
}

.middle {
    font-size: 28px;
    font-weight: bold;
    color: #ffd700;
    background: rgba(255,215,0,0.15);
}

.list {
    text-align: left;
    max-width: 280px;
    margin: 0 auto;
}
</style>
</head>

<body>

<h1>âš½ çƒæ˜¯FCå¹´ä¼šæŠ½å¥–</h1>

<div class="card">
    <form id="drawForm" action="/draw" method="post">
        <select name="prize" id="prize">
            <option value="ä¸€ç­‰å¥–">ä¸€ç­‰å¥–</option>
            <option value="äºŒç­‰å¥–">äºŒç­‰å¥–</option>
            <option value="ä¸‰ç­‰å¥–">ä¸‰ç­‰å¥–</option>
        </select>
        <br>
        <button type="button" onclick="startDraw()">ğŸ‰ å¼€å§‹æŠ½å¥–</button>
    </form>

    <!-- ğŸ° æ»šåŠ¨æŠ½å¥–æ¡† -->
    <div class="roller" id="roller" style="display:none">
        <div class="row" id="top">---</div>
        <div class="row middle" id="mid">---</div>
        <div class="row" id="bottom">---</div>
    </div>
</div>

<div class="card">
    <form action="/clean_duplicates" method="post">
        <button>ğŸ§¹ æ¸…ç†é‡å¤æ³¨å†Œ</button>
    </form>
    <form action="/reset_lottery" method="post">
        <button class="danger">â™» é‡ç½®æŠ½å¥–ï¼ˆæµ‹è¯•ç”¨ï¼‰</button>
    </form>
</div>

<div class="card">
    <h3>ğŸ¯ å½“å‰å¯æŠ½äººæ•°ï¼š{{ available_players|length }}</h3>
</div>

<script>
const names = {{ available_players|tojson }};

let timer = null;

function randomName() {
    return names[Math.floor(Math.random() * names.length)];
}

function startDraw() {
    if (names.length === 0) {
        alert("æš‚æ— å¯æŠ½äººå‘˜");
        return;
    }

    document.getElementById("roller").style.display = "block";

    timer = setInterval(() => {
        document.getElementById("top").innerText = randomName();
        document.getElementById("mid").innerText = randomName();
        document.getElementById("bottom").innerText = randomName();
    }, 80);

    // ğŸ¯ 3 ç§’ååœæ­¢æ»šåŠ¨ï¼Œå¹¶çœŸæ­£æŠ½å¥–
    setTimeout(() => {
        clearInterval(timer);
        document.getElementById("drawForm").submit();
    }, 3000);
}
</script>

</body>
</html>